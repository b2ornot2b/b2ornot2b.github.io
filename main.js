// Generated by CoffeeScript 1.9.2
window.sworker = function(msg) {
  return new Promise(function(resolve, reject) {
    var channel;
    console.log('promise');
    channel = new MessageChannel();
    channel.port1.onmessage = function(event) {
      console.log('onmessage', event);
      if (event.data.error) {
        return reject(event.data.error);
      } else {
        return resolve(event.data);
      }
    };
    return navigator.serviceWorker.controller.postMessage(msg, [channel.port2]);
  });
};

window.offerClicked = function(event) {
  var content, url;
  console.log('offerClicked', event);
  url = document.querySelector('#url').value.trim();
  content = document.querySelector('#data').value.trim();
  console.log('url', url, data);
  window.sworker({
    command: 'keys'
  }).then(function(data) {
    return console.log('keys', data);
  });
  if (url.length !== 0) {
    console.log(url, data);
    return window.sworker({
      command: 'add',
      url: url,
      content: content.length === 0 ? null : content
    }).then(function(data) {
      return console.log('add', url, content, data);
    });
  }
};

//# sourceMappingURL=main.js.map
